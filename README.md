# Go IM Chat - 简易即时通讯系统

本项目是一个基于 Go 语言实现的简易命令行即时通讯系统，包含独立的服务端和客户端，支持多用户在线、公聊、私聊、改名等功能。

## 目录结构

```
go-im-chat/
├── server/      # 服务端代码
│   ├── go.mod
│   ├── main.go
│   ├── server.go
│   ├── user.go
├── client/      # 客户端代码
│   ├── go.mod
│   ├── main.go
│   ├── client.go
└── README.md
```

## 编译与运行

### 1. 启动服务端

```sh
cd server
go build -o ./bin/server main.go server.go user.go
./bin/server
```

服务端默认监听 `127.0.0.1:8888`，可在代码中修改。

### 2. 启动客户端

```sh
cd client
go build -o ./bin/client main.go client.go
./bin/client -ip 127.0.0.1 -port 8888
```

可通过参数指定服务器 IP 和端口。

## 功能说明

- **公聊模式**：所有在线用户可见消息。
- **私聊模式**：指定用户点对点消息。
- **修改用户名**：支持在线更名，用户名唯一。
- **自动踢出**：长时间无操作自动下线。

## 代码结构说明

- `server/` 目录下为服务端代码，包含用户管理、消息广播、连接处理等。
- `client/` 目录下为客户端代码，包含菜单交互、消息收发等。
- `bin/`    目录下为可执行程序

## 数据格式说明

客户端与服务端之间通过 TCP 文本协议通信，主要数据格式如下：

- 用户上线/下线通知：
  - 服务器推送：`[ip:port]用户名: 已上线` 或 `[ip:port]用户名: 下线了`

- 修改用户名：
  - 客户端发送：`rename|新用户名\n`
  - 服务器响应：`你已更改用户名为新用户名...`

- 公聊消息：
  - 客户端发送：`消息内容\n`
  - 服务器广播：`用户名说: 消息内容`

- 私聊消息：
  - 客户端发送：`to|目标用户名|消息内容\n`
  - 服务器响应：`[你对 目标用户名 说]: 消息内容` 或 `[目标用户名对你说]: 消息内容`

- 查看当前在线用户：
  - 客户端发送：`who\n`
  - 服务器响应：`当前在线用户列表...`

- 退出登录：
  - 客户端发送：`exit\n`
  - 服务器响应：`[ip:port]用户名: 下线了`

> 注：所有消息以换行符 `\n` 结尾。

---

## 依赖

- Go 1.18 及以上版本

## 贡献

欢迎提交 issue 和 PR！

---

如需进一步功能扩展或问题反馈，请联系作者。
